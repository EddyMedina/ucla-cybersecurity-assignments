# Week 10 - Cryptography
### Topics covered in this assignment:
- Encryption
- Decryption
- Caesar Cipher
- Encoding and Decoding
- Binary
- Symmetric and Asymmetric Encryption
- Open SSL
- Key/IV
- Public/Private Keys
- Key Distribution
- Hashing
- Hashing Algorithms
- Hashcat
- Steganography
- Steghide
**Website**: [https://sites.google.com/view/cryptobreakout/](Website: https://sites.google.com/view/cryptobreakout/)

### Instructions:
In order to solve each riddle, you will need to apply cryptographic concepts covered in the past three lessons.
concepts will need to be applied.
- Once the riddle has been solved, submit your answer on the bottom of each Riddle Page.
- If you are correct, you will receive a key. Save this key in your notes.
- Once you have collected all six keys, select the Ransomware Decrypted header on the website and enter all your keys.
- If all the six keys are correct, the ransomware will be removed and the data will be decrypted.
- You will need to submit a screenshot as proof that the ransomware has been decrypted.
## CryptoBreakout Assignment
### Riddle 1

![Image](https://www.dropbox.com/s/9cpjn8upemjsiey/SyMGLswAU_B1PkjjPCL.png?dl=1)


Used: **https://cryptii.com/pipes/caesar-cipher** - shifted the key to 8.
![Image](https://www.dropbox.com/s/vkymmq23ripq6xp/SyMGLswAU_rkFejoPRL.png?dl=1)

Entered the plaintext and received this answer:
![Image](https://www.dropbox.com/s/v2j2t71fq3wekm0/SyMGLswAU_ryjZoiD0I.png?dl=1)
**Key 1: 6skd8s**
---
### Riddle 2
![Image](https://www.dropbox.com/s/b3cqoxh57edrq3v/SyMGLswAU_B1_G2iPCI.png?dl=1)


Used: **https://www.binaryhexconverter.com/binary-to-ascii-text-converter**

![Image](https://www.dropbox.com/s/pn3jjtsu3ugwm5n/SyMGLswAU_By9Y2svAU.png?dl=1)

Entered the plaintext and received this answer:

![Image](https://www.dropbox.com/s/yq05ae8fxhj8aln/SyMGLswAU_r1N22jwAL.png?dl=1)
**Key 2: cy8snd2**
---
### Riddle 3

![Image](https://www.dropbox.com/s/uvllyv8cnb46fnh/SyMGLswAU_Sydc1hPC8.png?dl=1)

First, I copied the cipher text onto a text file:
```bash
cristina@kali:~/Desktop$ echo "4qMOIvwEGXzvkMvRE2bNbg==" >> ciphertext_riddle.txt.enc
cristina@kali:~/Desktop$ cat ciphertext_riddle.txt.enc 
4qMOIvwEGXzvkMvRE2bNbg==
```

Second, I used **openssl** to decrypt the message using the options given in the riddle:
```bash
cristina@kali:~/Desktop$ sudo openssl enc -pbkdf2 -nosalt -aes-256-cbc -in ciphertext_riddle.txt.enc -d -base64 -K 5284A3B154D99487D9D8D8508461A478C7BEB67081A64AD9A15147906E8E8564 -iv 1907C5E255F7FC9A6B47B0E789847AED
[sudo] password for cristina: 
takagi
```

Entered the plaintext and received this answer:

![Image](https://www.dropbox.com/s/zlg97xqk59wr93o/SyMGLswAU_r1EWBnPAL.png?dl=1)
**Key 3: ud6s98n**

---
### Riddle 4

![Image](https://www.dropbox.com/s/kz0xsfbx3c0ij9w/SyMGLswAU_SyF8HnPR8.png?dl=1)

**The first answer is:**
![Image](https://www.dropbox.com/s/4gkjj68ggrm955k/SyMGLswAU_S1TlUnvRU.png?dl=1)

**The second answer is:** 
![Image](https://www.dropbox.com/s/oa3o3sraai58wj7/SyMGLswAU_B1MN82w08.png?dl=1)

**The third answer is:**
![Image](https://www.dropbox.com/s/if9j1ygs6tscw56/SyMGLswAU_r1gnL3vCU.png?dl=1)

**The fourth answer is:**
![Image](https://www.dropbox.com/s/hakm4bpuxx2tp3g/SyMGLswAU_SyBtd2wRL.png?dl=1)

**Received this answer:**

![Image](https://www.dropbox.com/s/b02cjm3dnahm69b/SyMGLswAU_rkzuFhvA8.png?dl=1)

**Key: 7gsn3nd2**

---
### Riddle 5

![Image](https://www.dropbox.com/s/va6kdkt2kqxtmjn/SyMGLswAU_HkeptnvCL.png?dl=1)

First, I copied the hash onto a txt file:
```bash
cristina@kali:~/Desktop$ echo "3b75cdd826a16f5bba0076690f644dc7" >> hash_riddle.txt
cristina@kali:~/Desktop$ cat hash_riddle.txt 
3b75cdd826a16f5bba0076690f644dc7
```

Second, I used **hashcat** to crack the hash using md5 as the mode:
```bash
cristina@kali:~/Desktop$ hashcat -m 0 -a 0 -o solved_hash.txt hash_riddle.txt rockyou.txt --force
hashcat (v5.1.0) starting...

OpenCL Platform #1: The pocl project
====================================
* Device #1: pthread-Intel(R) Core(TM) i3-8100B CPU @ 3.60GHz, 512/1472 MB allocatable, 1MCU

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

ATTENTION! Pure (unoptimized) OpenCL kernels selected.
This enables cracking passwords and salts > length 32 but for the price of drastically reduced performance.                                                           
If you want to switch to optimized OpenCL kernels, append -O to your commandline.

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

* Device #1: build_opts '-cl-std=CL1.2 -I OpenCL -I /usr/share/hashcat/OpenCL -D LOCAL_MEM_TYPE=2 -D VENDOR_ID=64 -D CUDA_ARCH=0 -D AMD_ROCM=0 -D VECT_SIZE=8 -D DEVICE_TYPE=2 -D DGST_R0=0 -D DGST_R1=3 -D DGST_R2=2 -D DGST_R3=1 -D DGST_ELEM=4 -D KERN_TYPE=0 -D _unroll'                                                                
Dictionary cache hit:
* Filename..: rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Type........: MD5
Hash.Target......: 3b75cdd826a16f5bba0076690f644dc7
Time.Started.....: Mon Jun 29 12:39:04 2020 (0 secs)
Time.Estimated...: Mon Jun 29 12:39:04 2020 (0 secs)
Guess.Base.......: File (rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   201.3 kH/s (0.17ms) @ Accel:1024 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts
Progress.........: 18432/14344385 (0.13%)
Rejected.........: 0/18432 (0.00%)
Restore.Point....: 17408/14344385 (0.12%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: paramedic -> tanika

Started: Mon Jun 29 12:39:02 2020
Stopped: Mon Jun 29 12:39:05 2020
```

Third, I used "cat" on the solved_hash.txt to see the cracked text:
```bash
cristina@kali:~/Desktop$ cat solved_hash.txt 
3b75cdd826a16f5bba0076690f644dc7:argyle 
```

I received this answer:

![Image](https://www.dropbox.com/s/om4mbvi399hg6ly/SyMGLswAU_rkqJ4TwRL.png?dl=1)

**Key: ajy39d2**

---
### Riddle 6
![Image](https://www.dropbox.com/s/7eo0sjxm1air3sv/SyMGLswAU_Sk6_VTDRL.png?dl=1)
**Image:**

![Image](https://www.dropbox.com/s/3kqmenzqpxkf281/SyMGLswAU_Bk7c4TPRU.png?dl=1)

Based on the riddle, I knew I needed to use Steghide and use "ABC" as the passphrase:
```bash
cristina@kali:~/Desktop$ steghide extract -sf mary-lamb.jpg 
Enter passphrase: 
wrote extracted data to "code_is_inside_this_file.txt".
```

The passphrase worked! So I used "cat" to view the code in the file:
```bash
cristina@kali:~/Desktop$ cat code_is_inside_this_file.txt 
mcclane
```

I entered the code and got this answer:

![Image](https://www.dropbox.com/s/q8lm7ytxdotzm2s/SyMGLswAU_Sy6jB6w0U.png?dl=1)

**Key: 7skahd6**

---
### Ransomware Decrypter
I entered all the keys into the decrypter:
1. 6skd8s
1. cy8snd2
1. ud6s98n
1. 7gsn3nd2
1. ajy39d2
1. 7skahd6
I received this answer:

![Image](https://www.dropbox.com/s/ynb3r1h4z2eys9n/SyMGLswAU_rJatLpP0L.png?dl=1)

---
## Azure Account Set-Up

![Image](https://www.dropbox.com/s/ksy5k3nrw9v21mb/SyMGLswAU_HJkxcivC8.png?dl=1)


